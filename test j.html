<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Booking</title>
    <link rel="stylesheet" href="path/to/font-awesome/css/font-awesome.min.css"> <!-- Update with your font-awesome path -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <style>
        .red-btn {
            background-color: red;
            color: white;
        }
        .gray-btn {
            background-color: gray;
            color: white;
        }
    </style>
</head>
<body>
    <form id="bookingForm">
        <input type="text" id="location" placeholder="Location">
        <input type="text" id="dates" placeholder="Select dates">
        <input type="text" id="guests" placeholder="Guests" readonly>
        <div id="guestsDropdown" class="dropdown-content">
            <div>
                <button id="adults-minus" class="gray-btn">-</button>
                <input type="text" id="adults" value="1" readonly>
                <button id="adults-plus" class="red-btn">+</button>
            </div>
            <div>
                <button id="children-minus" class="gray-btn">-</button>
                <input type="text" id="children" value="0" readonly>
                <button id="children-plus" class="red-btn">+</button>
            </div>
            <div>
                <button id="rooms-minus" class="gray-btn">-</button>
                <input type="text" id="rooms" value="1" readonly>
                <button id="rooms-plus" class="red-btn">+</button>
            </div>
            <button id="guests-done" type="button">Done</button>
        </div>
        <button type="submit">Submit</button>
    </form>

    <div class="col-12 col-lg-9 ">
        <div class="row mb-4">
            <div class="col-12">
                <div class="card shadow-0 border rounded-3 shadow-sm mb-2">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-12 col-md-4 col-lg-3 mb-4 mb-lg-0">
                                <div class="bg-image hover-zoom ripple rounded ripple-surface">
                                    <a href="../single-hotel-page/index.html" id="redirectLink">
                                        <img src="./hotel images/Screenshot (7) 1.jpg" class="w-100" />
                                    </a>
                                    <a href="#!">
                                        <div class="hover-overlay">
                                            <div class="mask" style="background-color: rgba(253, 253, 253, 0.15);"></div>
                                        </div>
                                    </a>
                                </div>
                            </div>
                            <div class="col-12 col-md-5 col-lg-6">
                                <h5>Ramana Towers</h5>
                                <div class="mt-1 mb-0 text-muted small">
                                    <div class="textright">
                                        <i class="fa-solid fa-location-dot" style="color: red;"></i>
                                        <span>Opp to Ramana ashram</span><br>
                                        <span class="ms-3">1.5 km drive to Arunachaleswara Temple</span>
                                    </div>
                                </div>
                                <div class="mb-2 text-muted small">
                                    <i class="fa-solid fa-check" style="color: red;"></i>
                                    <span>24-room service</span>
                                </div>
                                <div class="d-flex flex-row align-items-center mb-1">
                                    <span class="pe-2 text-secondary"><s>₹2699</s></span>
                                    <h4 class="mb-1 me-1">₹1874</h4>
                                </div>
                                <p style="font-size: 15px;">+ ₹468 TAXES & FEES</p>
                                <button class="btn text-light btn-sm" style="width: 126px; background-color: red;" type="button">See availability</button>
                            </div>
                            <div class="col-12 col-md-3 col-lg-3 border-sm-start-none">
                                <div class="d-flex justify-content-end">
                                    <div class="align-items-end">
                                        <h4 class="text-danger mt-2 ps-4 me-2 text-end" style="font-size: 16px;">Good <br>
                                            <span class="" style="font-size: 12px; color: gray;">480 review</span>
                                        </h4>
                                    </div>
                                    <div class="right rounded-1">
                                        <div style="font-size:15px;"><b>5.2</b></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Add more cards here -->
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            // Initialize Flatpickr for date selection
            var dateRangePicker = flatpickr("#dates", {
                mode: "range",
                dateFormat: "d, F Y",
                minDate: "today", // Disable past dates
                defaultDate: [new Date(), new Date()], // Default check-in and check-out to today
                onClose: function(selectedDates) {
                    if (selectedDates.length === 2) {
                        sessionStorage.setItem('checkin', selectedDates[0].toLocaleDateString());
                        sessionStorage.setItem('checkout', selectedDates[1].toLocaleDateString());
                    }
                }
            });

            // Retrieve data from sessionStorage and set it in the form
            var location = sessionStorage.getItem('location') || 'Tiruvannamalai';
            var checkin = sessionStorage.getItem('checkin');
            var checkout = sessionStorage.getItem('checkout');
            var adults = sessionStorage.getItem('adults') || 1;
            var children = sessionStorage.getItem('children') || 0;
            var rooms = sessionStorage.getItem('rooms') || 1;

            document.getElementById('location').value = location;
            if (checkin && checkout) {
                dateRangePicker.setDate([new Date(checkin), new Date(checkout)]);
            } else {
                dateRangePicker.setDate([new Date(), new Date()]);
            }
            document.getElementById('adults').value = adults;
            document.getElementById('children').value = children;
            document.getElementById('rooms').value = rooms;
            updateGuests();
            updateButtonsState();

            // Toggle guests dropdown visibility
            document.getElementById('guests').addEventListener('click', function(event) {
                var dropdown = document.getElementById('guestsDropdown');
                dropdown.classList.toggle('show');
                event.stopPropagation();
            });

            // Close dropdown if clicking outside
            document.addEventListener('click', function(event) {
                var dropdown = document.getElementById('guestsDropdown');
                if (!event.target.closest('#guestsDropdown') && !event.target.closest('#guests')) {
                    dropdown.classList.remove('show');
                }
            });

            // Add event listeners for incrementing and decrementing adults, children, and rooms
            document.getElementById('adults-plus').addEventListener('click', function() { incrementValue('adults', 30); });
            document.getElementById('adults-minus').addEventListener('click', function() { decrementValue('adults', 1); });
            document.getElementById('children-plus').addEventListener('click', function() { incrementValue('children', 10); });
            document.getElementById('children-minus').addEventListener('click', function() { decrementValue('children', 0); });
            document.getElementById('rooms-plus').addEventListener('click', function() { incrementValue('rooms', 30); });
            document.getElementById('rooms-minus').addEventListener('click', function() { decrementValue('rooms', 1); });

            // Done button to close the dropdown
            document.getElementById('guests-done').addEventListener('click', function() {
                document.getElementById('guestsDropdown').classList.remove('show');
                updateGuests();
            });

            // Function to increment the input value
            function incrementValue(inputId, maxValue) {
                var input = document.getElementById(inputId);
                var currentValue = parseInt(input.value);
                if (currentValue < maxValue) {
                    input.value = currentValue + 1;
                    updateGuests();
                    updateButtonsState();
                }
            }

            // Function to decrement the input value with a minimum value
            function decrementValue(inputId, minValue) {
                var input = document.getElementById(inputId);
                var currentValue = parseInt(input.value);
                if (currentValue > minValue) {
                    input.value = currentValue - 1;
                    updateGuests();
                    updateButtonsState();
                }
            }

            // Function to update the "Adults, Children & Rooms" input
            function updateGuests() {
                var adults = parseInt(document.getElementById('adults').value);
                var children = parseInt(document.getElementById('children').value);
                var rooms = parseInt(document.getElementById('rooms').value);

                var guests = `${adults} Adults, ${children} Children, ${rooms} Rooms`;
                document.getElementById('guests').value = guests;

                // Calculate total rate
                var baseRate = 2000;
                var extraAdultRate = 500;
                var extraChildRate = 300;
                var totalRate = baseRate + ((adults - 1) * extraAdultRate) + (children * extraChildRate) + ((rooms - 1) * baseRate);

                // Save updated values and rate to sessionStorage
                sessionStorage.setItem('adults', adults);
                sessionStorage.setItem('children', children);
                sessionStorage.setItem('rooms', rooms);
                sessionStorage.setItem('totalRate', totalRate);

                // Update rate in the HTML
                document.querySelector(".col-12.col-lg-9 .card-body .d-flex.flex-row.align-items-center.mb-1 h4").textContent = `₹${totalRate}`;
            }

            // Function to update the plus and minus buttons state
            function updateButtonsState() {
                var adults = parseInt(document.getElementById('adults').value);
                var children = parseInt(document.getElementById('children').value);
                var rooms = parseInt(document.getElementById('rooms').value);

                updateButtonState('adults-plus', 'adults-minus', adults, 30);
                updateButtonState('children-plus', 'children-minus', children, 10);
                updateButtonState('rooms-plus', 'rooms-minus', rooms, 30);
            }

            function updateButtonState(plusId, minusId, value, maxValue) {
                var plusButton = document.getElementById(plusId);
                var minusButton = document.getElementById(minusId);

                plusButton.className = value >= maxValue ? 'gray-btn' : 'red-btn';
                minusButton.className = value > 1 ? 'red-btn' : 'gray-btn';
            }

            // Submit event for booking form
            document.getElementById('bookingForm').addEventListener('submit', function(e) {
                e.preventDefault(); // Prevent the default form submission

                // Get form data
                var location = document.getElementById('location').value;
                var dateRange = document.getElementById('dates').value;
                var adults = document.getElementById('adults').value;
                var children = document.getElementById('children').value;
                var rooms = document.getElementById('rooms').value;

                // Split date range into check-in and check-out dates
                var dateParts = dateRange.split(" to ");
                var checkin = dateParts[0];
                var checkout = dateParts[1];

                // Save data to sessionStorage
                sessionStorage.setItem('location', location);
                sessionStorage.setItem('checkin', checkin);
                sessionStorage.setItem('checkout', checkout);

                // Redirect to the details page
                window.location.href = './details-page/details.html';
            });

            // Prevent manual input in the guest inputs
            ['adults', 'children', 'rooms'].forEach(id => {
                document.getElementById(id).readOnly = true;
            });
        });
    </script>
</body>
</html>
